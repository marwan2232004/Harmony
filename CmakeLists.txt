cmake_minimum_required(VERSION 4.0.0)
set(CMAKE_CXX_STANDARD 17)

project(AudioProcessor)

# Set vcpkg toolchain
set(CMAKE_TOOLCHAIN_FILE "C:/Users/Karim/vcpkg/scripts/buildsystems/vcpkg.cmake")

# Manually set TagLib path (use whichever exists from step 1)
set(TagLib_DIR "C:/Users/Karim/vcpkg/installed/x64-windows/share/taglib")
find_package(Threads REQUIRED)
find_package(TagLib REQUIRED) # Try both "TagLib" and "taglib"

add_executable(audio_processor core/src_files/data/getAudioLength.cpp)
target_link_libraries(audio_processor PRIVATE
        TagLib::TagLib
        Threads::Threads  # Required for std::thread
)
# Auto-copy DLLs to build directory
add_custom_command(TARGET audio_processor POST_BUILD
        COMMAND ${CMAKE_COMMAND} -E copy_if_different
        "C:/Users/Karim/vcpkg/installed/x64-windows/bin/tag.dll"
        $<TARGET_FILE_DIR:audio_processor>
)